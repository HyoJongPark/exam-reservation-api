# exam-reservation-api

### 과제 실행 방법

```
brew install pyenv
pyenv install 3.12.0

export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init --path)"
eval "$(pyenv init -)"

pyenv local 3.12.0
```

- 해당 프로젝트는 python version 3.12에서 작성되었습니다.
- 버전 문제로 실행되지 않은 시 `pyenv`를 사용해 프로젝트 환경에 맞는 버전을 설치하고, 재실행 시켜보시면 됩니다.

```
python -m venv venv

source ./venv/bin/activate  # macOS/Linux

pip install -r requirements.txt
```

- 가상환경을 설정합니다.

```
# 도커 실행 (DB)
docker compose -f docker-compose.yml up -d

# 파이썬 실행
PYTHONPATH=./app/src uvicorn main:app --reload
```

- DB는 도커 환경을 통해 실행됩니다. 따라서 도커 설치가 필요합니다.
- 도커 실행 후 파이썬 실행 명령어를 가상환경이 설정된 터미널 내에서 실행하면 API 호출이 가능합니다.

---

### 과제 요구사항

- [ ] 사용자은 예약 신청이 가능한 시간/인원을 알 수 있다.
  - [ ] 시작, 종료 구간을 Date(YYYY-MM-DD)로 입력받는다.
    - 입력 포맷과 맞지않는 입력은 예외발생
    - 시작, 종료 일자는 동일하거나 종료 일자가 더 커야한다.
  - [ ] 현재 예약된 인원이란 어드민에 의해 예약 확정된 인원만을 포함한다.
  - [ ] 응답은 10분 단위로 구성되고, 만약 다음 구간의 예약 가능 인원이 동일하다면 해당 구간들을 합해서 반환한다.
    - ex> (12:10 ~ 12:20: 40,000), (12:20 ~ 12:30: 40,000) 일 때 → (12:10 ~ 12:30: 40,000)을 반환함
  - [ ] 예약이 불가한 구간은 응답에 포함되지 않는다.
- [ ] 사용자는 (자신의) 특정 예약 정보를 조회할 수 있다.
  - 예약 ID를 쿼리 스트링으로 입력받는다.
  - 어드민은 모든 예약을 조회 가능하다.
  - 고객은 자신의 예약을 조회 가능하다.
    - 본인의 예약이외의 예약 정보 조회 시 예외 발생
  - 존재하지 않는 예약 조회 시 예외발생
- [ ] 사용자는 (자신의) 예약 정보들을 조회할 수 있다.
  - [ ] 시작, 종료 구간을 Date(YYYY-MM-DD)로 입력받는다.
    - 입력 포맷과 맞지않는 입력은 예외발생
    - 시작, 종료 일자는 동일하거나 종료 일자가 더 커야한다.
  - [ ] 어드민은 모든 예약을 조회 가능하다.
  - [ ] 고객은 자신의 예약만을 조회 가능하다.
  - [ ] 응답은 해당 구간 사이의 조회 가능한 모든 예약 정보를 포함한다.
- [ ] 사용자는 예약이 가능한 구간 내에서 예약을 진행할 수 있다.
  - [ ] 예약 시간, 예약 인원을 입력받는다.
    - 예약 시간은 Datetime(YYYY-MM-DD HH:MM)의 형식으로 구성되어야 한다.
    - 입력 포맷과 맞지 않는 입력은 예외 발생
    - 예약 인원은 최소 1명, 최대 5만명 사이여야 한다.
  - [ ] 최대 5만명의 예약을 수용 가능하다.
    - 구간 내에 5만명의 제한을 초과하는 구간이 존재하면 예외 발생
    - 확정되지 않은 예약은 5만명의 제한에 포함하지 않는다.
  - [ ] 사용자는 현재 일자로부터 3일 뒤의 예약만이 가능하다.
    - 3일 이내 예약 시 예외 발생
- [ ] 어드민은 고객의 대기 상태 예약을 확정할 수 있다.
  - [ ] 예약 ID를 쿼리 스트링으로 입력받는다.
  - [ ] 일반 사용자가 요청 시 예외 발생
  - [ ] 5만건이 넘는 예약에 대해서는 예약 실패 응답을 반환한다.
  - [ ] 동시 요청에 대해서도 5만건 정합성을 유지해야한다.
- [ ] 사용자는 자신의 예약 정보를 수정할 수 있다.
  - [ ] 예약 시간, 인원을 입력받는다.
    - 예약 시간, 인원 중 하나는 반드시 입력되어야하고, 입력되지 않으면 예외 발생
    - 예약 시간은 Datetime(YYYY-MM-DD HH:MM)의 형식으로 구성되어야 한다.
    - 예약 인원은 최소 1명, 최대 5만명 사이여야 한다.
  - [ ] 사용자는 예약 확정 전인 예약에 대해 수정이 가능하다.
  - [ ] 어드민은 모든 고객의 예약을 수정 가능하다.(예약 확정 포함)
  - [ ] 예약 수정 시 인원 및 시간이 수정된다면, 구간 내에 5만명의 제한을 초과해서는 안된다.
- [ ] 사용자는 자신의 예약 정보를 삭제할 수 있다.
  - [ ] 예약 ID를 쿼리 스트링으로 입력받는다.
  - [ ] 고객은 확정 전 본인의 예약을 삭제할 수 있다.
  - [ ] 어드민은 모든 고객의 예약을 삭제할 수 있다.
